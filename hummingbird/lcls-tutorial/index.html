<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <title>Hummingbird at LCLS</title>
    <link type="text/css" rel="stylesheet" href="assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="assets/css/hljs-github.min.css"/>
  </head>
  <body>
    <article class="markdown-body"><h1 id="hummingbird-at-lcls"><a class="header-link" href="#hummingbird-at-lcls"></a>Hummingbird at LCLS</h1>
<p>This is a step-by-step tutorial targeted to users of <strong>Hummingbird</strong> at the LCLS. The tutorial is maintained using this bitbucket repo: <a href="https://bitbucket.org/uu-lmb/lcls-tutorial">https://bitbucket.org/uu-lmb/lcls-tutorial</a>, so if you have not already done so, make a local clone of the project:</p>
<pre class="hljs"><code>git clone git@bitbucket.org:uu-lmb/lcls-tutorial.git /path/to/tutorial/</code></pre><p>and open this document in your browser:</p>
<pre class="hljs"><code>cd /path/to/tutorial
open docs/build/index.html</code></pre><p>This page is also available here: <a href="http://fxihub.github.io/hummingbird/lcls_tutorial">http://fxihub.github.io/hummingbird/lcls_tutorial</a></p>
<h2 id="1-the-network-at-lcls"><a class="header-link" href="#1-the-network-at-lcls"></a>1. The Network at LCLS</h2>
<p>First, you should make yourself familiar with the network at LCLS, it looks like this:</p>
<p class="img-container"><img src="images/lcls-network.png" alt="LCLS network"></p>
<p>For running <strong>Hummingbird</strong> at LCLS, there are mainly two scenarios: the <em>online</em> and the <em>offline</em> case. </p>
<p>When running <em>online</em>, you should be logged into one of the <em>operator</em> machines (<code>amoopr@amo-console</code> or <code>cxiopr@cxi-console</code>) from where you are able to run the <strong>Hummingbird</strong> backend over SSH on one of the DAQ monitoring machines (<code>daq-amo-monXX</code> or <code>daq-cxi-monXX</code>) and the <strong>Hummingbird</strong> frontend directly from the <em>operator</em> machine (<code>amo-console</code> or <code>cxi-console</code>) such that the real-time figures can be displayed on one of the big screens. </p>
<p>When running <em>offline</em>, you are either logged into one of the <em>psusr</em> machines (<code>psusr11Y</code>) or connected from outside the LCLS to one of the <code>psana</code> nodes through <code>pslogin</code>. Here, the <strong>Hummingbird</strong> backend should run on a <code>psana</code> node, while the frontend can be run on <code>psusr</code>, <code>psana</code> (using X-forwarding) or locally (using an SSH tunnel).</p>
<h2 id="2-installation"><a class="header-link" href="#2-installation"></a>2. Installation</h2>
<p>There are two different repositories, one for <strong>Hummingbird</strong> itself (<a href="https://github.com/FXIhub/hummingbird">https://github.com/FXIhub/hummingbird</a>), the other one for configuration and other beamtime specific files (<a href="https://bitbucket.org/uu-lmb/">https://bitbucket.org/uu-lmb/</a>). We keep seperate configuration repos for each experiment.</p>
<h3 id="preparations-for-running-online"><a class="header-link" href="#preparations-for-running-online"></a>Preparations for running online</h3>
<p>Logged into one of the operator machines (<code>amoopr@amo-console</code> or <code>cxiopr@cxi-console</code>), there should be a beamtime folder, e.g. <code>amo87215</code>. Inside this folder, we clone <strong>Hummingbird</strong> into a folder we call <code>hummingbird</code>:</p>
<pre class="hljs"><code>git clone https://github.com/FXIhub/hummingbird.git</code></pre><p>We also clone the <strong>Configuration/Beamtime</strong> repository inside <code>configuration</code>:</p>
<pre class="hljs"><code>git clone git@bitbucket.org:uu-lmb/amo87215.git</code></pre><p>In case there is no existing <strong>Configuration/Beamtime</strong> repository, just clone one of the template repositories (TODO: add template repos) and create a new beamtime repository. As we are running <strong>Hummingbird</strong> outside of its source directory, we should add the hummingbird source directory to our path:</p>
<pre class="hljs"><code>export PATH=$PATH:/path/to/hummingbird</code></pre><h3 id="preparations-for-running-offline"><a class="header-link" href="#preparations-for-running-offline"></a>Preparations for running offline</h3>
<p>The easiest is to have the same repositories (as mentioned above) in your <code>$HOME</code> directory. </p>
<h3 id="dependencies"><a class="header-link" href="#dependencies"></a>Dependencies</h3>
<p>All necessary dependencies for <strong>Hummingbird</strong> should be already installed in <code>/reg/g/uppsala/</code>. Just run</p>
<pre class="hljs"><code>source source_this</code></pre><p>or</p>
<pre class="hljs"><code>source source_this_on_rhel5</code></pre><p>on machines that are still running with <strong>RHEL 5</strong>. You should find these source files inside the <strong>Configuration/Beamtime</strong> repository.</p>
<h2 id="3-getting-started"><a class="header-link" href="#3-getting-started"></a>3. Getting started</h2>
    </article>
  </body>
</html>
